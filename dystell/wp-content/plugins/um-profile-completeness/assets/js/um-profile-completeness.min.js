"object"!=typeof wp.UM&&(wp.UM={}),"object"!=typeof wp.UM.profile_completeness&&(wp.UM.profile_completeness={widget:{wrapper:{},build:function(t){wp.ajax.send("um_profile_completeness_get_widget",{data:{is_profile:t.data("is_profile"),user_id:t.data("user_id"),nonce:um_scripts.nonce},success:function(e){wp.UM.profile_completeness.widget.set_content(e),t.addClass("um-is-loaded"),init_tipsy()},error:function(e){console.error(e)}})},set_content:function(e){var t=wp.template("ultimatemember_profile_completeness");wp.UM.profile_completeness.widget.wrapper.html(t(e))}},popup:{init_plugins:function(e){e.find(".um-s1").select2({allowClear:!0,minimumResultsForSearch:10}),e.find(".um-datepicker").each(function(){var e=jQuery(this),t=!1;""!==e.attr("data-disabled_weekdays")&&(t=JSON.parse(e.attr("data-disabled_weekdays")));var n=e.attr("data-years"),o=e.attr("data-date_min"),s=e.attr("data-date_max");o=o.split(","),s=s.split(","),e.pickadate({selectYears:n,min:o,max:s,disable:t,format:e.attr("data-format"),formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()}})}),e.find(".um-timepicker").each(function(){var e=jQuery(this);e.pickatime({format:e.attr("data-format"),interval:parseInt(e.attr("data-intervals")),formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()}})})},load:function(e){var t=e.data("key");if(void 0===t||e.parents(".um-completeness-step").hasClass("completed")){if(!e.parents(".um-completeness-step").hasClass("is-core"))return!1}else prepare_Modal(),wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:t,nonce:um_scripts.nonce},success:function(e){show_Modal(e),responsive_Modal(),wp.UM.profile_completeness.popup.init_plugins(jQuery(".um-popup"))},error:function(e){remove_Modal(),console.error(e)}})},save:function(s){var t,e=!0,n=s.find(".um-completeness-editwrap").find("input[type=text],input[type=radio],input[type=checkbox],textarea,select").attr("type"),p=s.find(".um-completeness-editwrap").find("input[type=text],input[type=radio],input[type=checkbox],textarea,select").attr("name");return p||(p=s.find(".um-completeness-editwrap").data("key")),s.find(".um-completeness-editwrap").find("select").length&&0===s.find(".um-completeness-editwrap").find(".picker").length&&(n="select",p=s.find(".um-completeness-editwrap").find("select").attr("id")),"radio"===n?(t=jQuery('input[name="'+p+'"]:checked').val())&&(e=!1):"checkbox"===n?(t=[],jQuery('input[name="'+p+'"]:checked').each(function(e){t.push(jQuery(this).val())}),t&&(e=!1,t=t.join(", "))):"select"===n?((t=jQuery("#"+p).val())&&(e=!1),jQuery(".um-popup select[multiple]").length&&t&&(e=!1,t=t.join(", "))):(1===s.find(".um-completeness-editwrap").find("textarea").length&&(p=s.find(".um-completeness-editwrap").find("textarea").attr("id")),t=jQuery(".um-completeness-field #"+p).val(),s.find(".picker").length&&(t=jQuery("#"+p+"_hidden").val()||jQuery("#"+p).parents(".um-field-area").find("[type=hidden][name="+p+"]").val()),0<t.trim().length&&(e=!1)),p=(p=p.replace("[]","")).replace("um_completeness_widget_",""),e||!t?s.find('input[name="'+p+'"]').focus():(s.addClass("um-visible-overlay"),wp.ajax.send("um_profile_completeness_save_popup",{data:{key:p,value:t,nonce:um_scripts.nonce},success:function(e){var t=jQuery('.um-completeness-bar[data-user_id="'+e.user_id+'"]');t.attr("original-title",e.percent+wp.i18n.__("% Complete","um-profile-completeness")),t.find(".um-completeness-done").animate({width:e.percent+"%"}),jQuery('.um-completeness-jx[data-user_id="'+e.user_id+'"]').html(e.percent),wp.UM.profile_completeness.widget.build(jQuery('.um-completeness-widget[data-user_id="'+e.user_id+'"]'));var n=jQuery(".um-completeness-step[data-key="+p+"]");n.addClass("completed");var o=n.next(".um-completeness-step:not(.completed,.is-core)").data("key");o?wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:o,nonce:um_scripts.nonce},success:function(e){s.removeClass("um-visible-overlay"),show_Modal(e),responsive_Modal(),wp.UM.profile_completeness.popup.init_plugins(s)},error:function(e){remove_Modal(),console.error(e)}}):(remove_Modal(),void 0!==e.redirect&&""!==e.redirect?window.location=e.redirect:location.reload())},error:function(e){console.log(e),location.reload()}})),!1},skip:function(t){var e=jQuery(".um-completeness-editwrap").attr("data-key"),n=jQuery(".um-completeness-step[data-key="+e+"]").next(".um-completeness-step:not(.completed,.is-core)").attr("data-key");return t.addClass("um-visible-overlay"),n?wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:n,nonce:um_scripts.nonce},success:function(e){t.removeClass("um-visible-overlay"),show_Modal(e),responsive_Modal(),wp.UM.profile_completeness.popup.init_plugins(t)},error:function(e){remove_Modal(),console.error(e)}}):remove_Modal(),!1}},init:function(){wp.UM.profile_completeness.widget.wrapper=jQuery(".um-completeness-widget-wrapper"),wp.UM.profile_completeness.widget.wrapper.length&&wp.UM.profile_completeness.widget.wrapper.each(function(){wp.UM.profile_completeness.widget.build(jQuery(this).parents(".um-completeness-widget"))}),jQuery(document.body).on("click",".um-completeness-save a.skip",function(e){e.preventDefault(),wp.UM.profile_completeness.popup.skip(jQuery(this).parents(".um-popup"))}),jQuery(document.body).on("click",".um-completeness-save a.save",function(e){e.preventDefault(),wp.UM.profile_completeness.popup.save(jQuery(this).parents(".um-popup"))}),jQuery(document.body).on("click",".um-completeness-edit",function(e){var t=jQuery(this);t.hasClass("um-real-url")||wp.UM.profile_completeness.popup.load(t)}),jQuery(document.body).on("click",'body.um-own-profile a[data-modal="um_upload_single"]',function(e){var t=jQuery(".um-completeness-widget").attr("data-user_id");t&&jQuery("#um_upload_single").attr("data-user_id",t)})}}),jQuery(document).ready(function(){wp.UM.profile_completeness.init()});